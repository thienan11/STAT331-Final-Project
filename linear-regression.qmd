---
title: "STAT331 Final Project - Linear Regression"
author: "Thien An Tran, Tejasree Kandibanda, Matthew Huang, Chloe Anbarcioglu"
format: 
  html:
    embed-resources: true
    code-tools: true
    toc: true
editor: source
execute: 
  error: true
  echo: true
  message: false
  warning: false
code-fold: true
---

## Setup

```{r}
library(tidyverse)
library(here)
library(gganimate)

happiness_merged <- read_csv(here::here("data", "murder_happiness.csv"))
```

## Data Visualizations

### Plot 1:

```{r}
happiness_merged |>
  group_by(year) |>
  summarise(avg_murder_rate = mean(murder_rate_per_100k),
            avg_happiness_score = mean(happiness_score)) |>
  ggplot(aes(x = avg_murder_rate,
             y = avg_happiness_score)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
    labs(title = "Relationship Between Murder Rate and Happiness Score") +
    theme_minimal()
```

```{r}
happiness_merged |>
  group_by(country) |>
  summarise(avg_murder_rate = mean(murder_rate_per_100k),
            avg_happiness_score = mean(happiness_score)) |>
  ggplot(aes(x = avg_murder_rate, 
             y = avg_happiness_score)
         ) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
    labs(title = "Relationship Between Murder Rate and Happiness Score",
         x = "Average Murder Rate (per 100k)", y = "Average Happiness Score") +
    theme_minimal()
```

### Plot 2:



